{"Outputs":{},"Parameters":{"LogPublicationControl":{"Default":"false","NoEcho":"true","Description":"If true customer service logs will be published to S3.","AllowedValues":["true","false"],"Type":"String","ConstraintDescription":"must be Boolean."},"HooksPkgUrl":{"Default":"https:\/\/s3.amazonaws.com\/elasticbeanstalk-env-resources-us-east-1\/stalks\/eb_docker_python3_3.12.1\/lib\/hooks.tar.gz","NoEcho":"true","Description":"URL to hooks package","Type":"String"},"AWSEBReferrerId":{"Default":"","NoEcho":"true","Type":"String"},"DockerProxyServer":{"Default":"nginx","NoEcho":"true","Description":"Specifies which proxy server to be used for client connections.","AllowedValues":["nginx","none"],"Type":"String"},"InstancePort":{"Default":"80","NoEcho":"true","Description":"Listen Port","Type":"String"},"AWSEBEnvironmentId":{"NoEcho":"true","Type":"String"},"AWSEBAgentId":{"Default":"","NoEcho":"true","Type":"String"},"AWSEBEnvironmentName":{"NoEcho":"true","Type":"String"},"AWSEBEnvironmentBucket":{"NoEcho":"true","Type":"String"},"AppSource":{"Default":"http:\/\/elasticbeanstalk-samples-us-east-1.s3.amazonaws.com\/python3-sample.zip","NoEcho":"true","Description":"The url of the application source.","Type":"String"},"EnvironmentVariables":{"Default":"PARAM1=,PARAM2=,PARAM3=,PARAM4=,PARAM5=","NoEcho":"true","Description":"Program environment variables.","Type":"CommaDelimitedList"},"InstanceType":{"Default":"t1.micro","NoEcho":"true","Description":"WebServer EC2 instance type","AllowedValues":["t2.micro","t2.small","t2.medium","m3.medium","m3.large","m3.xlarge","m3.2xlarge","c3.large","c3.xlarge","c3.2xlarge","c3.4xlarge","c3.8xlarge","t1.micro","m1.small","m1.medium","m1.large","m1.xlarge","c1.medium","c1.xlarge","c4.large","c4.xlarge","c4.2xlarge","c4.4xlarge","c4.8xlarge","m2.xlarge","m2.2xlarge","m2.4xlarge","cc1.4xlarge","cc2.8xlarge","cg1.4xlarge","hi1.4xlarge","hs1.8xlarge","cr1.8xlarge","g2.2xlarge","i2.xlarge","i2.2xlarge","i2.4xlarge","i2.8xlarge","r3.large","r3.xlarge","r3.2xlarge","r3.4xlarge","r3.8xlarge"],"Type":"String","ConstraintDescription":"must be a valid EC2 instance type."}},"Description":"AWS Elastic Beanstalk environment (Name: 'nandoAutomationDemo-env'  Id: 'e-znztckesyk')","Mappings":{"EnvironmentInfoTasks":{"systemtail":{"AutoClean":"true","CommandName":"CMD-SystemTailLogs","LocationPrefix":"resources\/environments\/logs\/systemtail\/"},"bundle":{"AutoClean":"true","CommandName":"CMD-BundleLogs","LocationPrefix":"resources\/environments\/logs\/bundle\/"},"publish":{"LocationPrefix":"resources\/environments\/logs\/publish\/"},"tail":{"AutoClean":"true","CommandName":"CMD-TailLogs","LocationPrefix":"resources\/environments\/logs\/tail\/"}},"AWSEBOptions":{"options":{"FastVersionDeployment":"true","nodeploymentOnStartup":"true","rpms":"https:\/\/s3.amazonaws.com\/elasticbeanstalk-env-resources-us-east-1\/stalks\/eb_docker_python3_3.12.1\/lib\/python-certifi-0.0.8-2.3.amzn1.noarch.rpm https:\/\/s3.amazonaws.com\/elasticbeanstalk-env-resources-us-east-1\/stalks\/eb_docker_python3_3.12.1\/lib\/aws-cfn-bootstrap-bSigV4_4.rpm https:\/\/s3.amazonaws.com\/elasticbeanstalk-env-resources-us-east-1\/stalks\/eb_docker_python3_3.12.1\/lib\/aws-elasticbeanstalk-tools-1.14-1.noarch.rpm","EnvironmentType":"SingleInstance","ebpatchscripturl":["https:\/\/s3.amazonaws.com\/elasticbeanstalk-env-resources-us-east-1\/eb_patching_resources\/patch_instance.py"],"CloudConfigOptions":"","HaltStartupCommandsOnFailure":"true","tarballs":"https:\/\/s3.amazonaws.com\/elasticbeanstalk-env-resources-us-east-1\/stalks\/eb_docker_python3_3.12.1\/lib\/awseb-ruby-2.1.5-x86_64-20141120_2028.tar.gz","DefaultSSHPort":"22","DNSNameResource":"AWSEBEIP","guid":"c6bcc927b440","UserDataScript":"https:\/\/s3.amazonaws.com\/elasticbeanstalk-env-resources-us-east-1\/stalks\/eb_docker_python3_3.12.1\/lib\/UserDataScript.sh","DefaultsScript":"\/opt\/elasticbeanstalk\/containerfiles\/support\/container-defaults","LeaderTestScript":"\/opt\/elasticbeanstalk\/bin\/leader-test.sh","ebgems":"https:\/\/s3.amazonaws.com\/elasticbeanstalk-env-resources-us-east-1\/stalks\/eb_docker_python3_3.12.1\/lib\/beanstalk-core-1.1.gem https:\/\/s3.amazonaws.com\/elasticbeanstalk-env-resources-us-east-1\/stalks\/eb_docker_python3_3.12.1\/lib\/executor-1.0.gem","LaunchType":"Migration","pythonlibs":"https:\/\/s3.amazonaws.com\/elasticbeanstalk-env-resources-us-east-1\/stalks\/eb_docker_python3_3.12.1\/lib\/requests-0.13.5.tar.gz#md5=805fd122b4cfd224e15ff2f5288c5ba0 https:\/\/s3.amazonaws.com\/elasticbeanstalk-env-resources-us-east-1\/stalks\/eb_docker_python3_3.12.1\/lib\/tailer-0.3.tar.gz#md5=9d1fc073e48ca682786d50c077e823ce","EBSNSTopicArn":"","downloadSourceBundleScriptLocation":["https:\/\/s3.amazonaws.com\/elasticbeanstalk-env-resources-us-east-1\/eb_patching_resources\/download_source_bundle.py"],"EmbeddedConfigsetsEnabled":"true"}},"AWSEBAWSRegionArch2AMI":{"sa-east-1":{"pv":"ami-2d5fe730","graphics":"","hvm":"ami-335fe72e","gpu":""},"eu-central-1":{"pv":"ami-54360b49","graphics":"","hvm":"ami-56360b4b","gpu":""},"ap-northeast-1":{"pv":"ami-633ace63","graphics":"ami-cda89ecc","hvm":"ami-653ace65","gpu":""},"eu-west-1":{"pv":"ami-21f26d56","graphics":"ami-94e946e3","hvm":"ami-2ff26d58","gpu":"ami-2bf26d5c"},"us-east-1":{"pv":"ami-e04d6f88","graphics":"ami-f8942f90","hvm":"ami-e64d6f8e","gpu":"ami-f24d6f9a"},"us-west-1":{"pv":"ami-75cb2d31","graphics":"ami-2f786d6a","hvm":"ami-79cb2d3d","gpu":""},"us-west-2":{"pv":"ami-89ba97b9","graphics":"ami-51135c61","hvm":"ami-fbba97cb","gpu":""},"ap-southeast-2":{"pv":"ami-33b1c109","graphics":"ami-cbaec3f1","hvm":"ami-3db1c107","gpu":""},"ap-southeast-1":{"pv":"ami-36073664","graphics":"ami-dc75548e","hvm":"ami-30073662","gpu":""}},"ContainerMeta":{"AMIMeta":{"AMIVersion":"2014.09.1","RepoReleaseVersion":"2014.09"}},"AWSEBAWSInstanceType2Arch":{"cg1.4xlarge":{"Arch":"gpu"},"hs1.8xlarge":{"Arch":"pv"},"m1.large":{"Arch":"pv"},"i2.4xlarge":{"Arch":"hvm"},"m1.xlarge":{"Arch":"pv"},"c4.4xlarge":{"Arch":"hvm"},"c3.4xlarge":{"Arch":"hvm"},"c3.8xlarge":{"Arch":"hvm"},"m3.xlarge":{"Arch":"pv"},"t2.medium":{"Arch":"hvm"},"c3.2xlarge":{"Arch":"hvm"},"t2.micro":{"Arch":"hvm"},"m3.2xlarge":{"Arch":"pv"},"m1.small":{"Arch":"pv"},"r3.2xlarge":{"Arch":"hvm"},"t2.small":{"Arch":"hvm"},"r3.8xlarge":{"Arch":"hvm"},"m2.xlarge":{"Arch":"pv"},"m2.2xlarge":{"Arch":"pv"},"m3.large":{"Arch":"pv"},"r3.large":{"Arch":"hvm"},"m1.medium":{"Arch":"pv"},"r3.4xlarge":{"Arch":"hvm"},"m3.medium":{"Arch":"pv"},"c4.8xlarge":{"Arch":"hvm"},"g2.2xlarge":{"Arch":"graphics"},"cr1.8xlarge":{"Arch":"hvm"},"c3.xlarge":{"Arch":"hvm"},"c3.large":{"Arch":"hvm"},"cc2.8xlarge":{"Arch":"hvm"},"m2.4xlarge":{"Arch":"pv"},"i2.8xlarge":{"Arch":"hvm"},"c4.xlarge":{"Arch":"hvm"},"t1.micro":{"Arch":"pv"},"cc1.4xlarge":{"Arch":"hvm"},"hi1.4xlarge":{"Arch":"pv"},"c1.medium":{"Arch":"pv"},"r3.xlarge":{"Arch":"hvm"},"c1.xlarge":{"Arch":"pv"},"c4.2xlarge":{"Arch":"hvm"},"i2.2xlarge":{"Arch":"hvm"},"c4.large":{"Arch":"hvm"},"i2.xlarge":{"Arch":"hvm"}},"AWSEBAWSRegionArch2AMIBase":{"sa-east-1":{"pv":"ami-9137828c","graphics":"","hvm":"ami-8737829a","gpu":""},"eu-central-1":{"pv":"ami-a03503bd","graphics":"","hvm":"ami-b43503a9","gpu":""},"ap-northeast-1":{"pv":"ami-2385b022","graphics":"ami-cda89ecc","hvm":"ami-4985b048","gpu":""},"eu-west-1":{"pv":"ami-9c7ad8eb","graphics":"ami-94e946e3","hvm":"ami-6e7bd919","gpu":"ami-607bd917"},"us-east-1":{"pv":"ami-246ed34c","graphics":"ami-f8942f90","hvm":"ami-b66ed3de","gpu":"ami-bc6ed3d4"},"us-west-1":{"pv":"ami-9b6e64de","graphics":"ami-2f786d6a","hvm":"ami-4b6f650e","gpu":""},"us-west-2":{"pv":"ami-55a7ea65","graphics":"ami-51135c61","hvm":"ami-b5a7ea85","gpu":""},"ap-southeast-2":{"pv":"ami-71f7954b","graphics":"ami-cbaec3f1","hvm":"ami-63f79559","gpu":""},"ap-southeast-1":{"pv":"ami-ba5c7ae8","graphics":"ami-dc75548e","hvm":"ami-ac5c7afe","gpu":""}}},"AWSTemplateFormatVersion":"2010-09-09","Resources":{"AWSEBInstanceLaunchWaitCondition":{"Type":"AWS::CloudFormation::WaitCondition","DependsOn":"AWSEBAutoScalingGroup","Properties":{"Handle":{"Ref":"AWSEBInstanceLaunchWaitHandle"},"Timeout":"1200","Count":1}},"AWSEBAutoScalingLaunchConfiguration":{"Type":"AWS::AutoScaling::LaunchConfiguration","Properties":{"IamInstanceProfile":"aws-elasticbeanstalk-ec2-role","ImageId":{"Fn::FindInMap":["AWSEBAWSRegionArch2AMI",{"Ref":"AWS::Region"},{"Fn::FindInMap":["AWSEBAWSInstanceType2Arch",{"Ref":"InstanceType"},"Arch"]}]},"InstanceMonitoring":false,"SecurityGroups":[{"Ref":"AWSEBSecurityGroup"}],"UserData":{"Fn::Base64":{"Fn::Join":["",["Content-Type: multipart\/mixed; boundary=\"===============5189065377222898407==\"","\n","MIME-Version: 1.0","\n","","\n","--===============5189065377222898407==","\n","Content-Type: text\/cloud-config; charset=\"us-ascii\"","\n","MIME-Version: 1.0","\n","Content-Transfer-Encoding: 7bit","\n","Content-Disposition: attachment; filename=\"cloud-config.txt\"","\n","","\n","#cloud-config","\n","repo_upgrade: none","\n","repo_releasever: ",{"Fn::FindInMap":["ContainerMeta","AMIMeta","RepoReleaseVersion"]},"\n",{"Fn::FindInMap":["AWSEBOptions","options","CloudConfigOptions"]},"\n","","\n","--===============5189065377222898407==","\n","Content-Type: text\/x-shellscript; charset=\"us-ascii\"","\n","MIME-Version: 1.0","\n","Content-Transfer-Encoding: 7bit","\n","Content-Disposition: attachment; filename=\"user-data.txt\"","\n\n","#!\/bin\/bash","\n","exec > >(tee -a \/var\/log\/eb-cfn-init.log|logger -t [eb-cfn-init] -s 2>\/dev\/console) 2>&1","\n","echo [`date -u +\"%Y-%m-%dT%H:%M:%SZ\"`] Started EB User Data","\n","set -x","\n","\n\n","function sleep_delay ","\n","{","\n","  if (( $SLEEP_TIME < $SLEEP_TIME_MAX )); then ","\n","    echo Sleeping $SLEEP_TIME","\n","    sleep $SLEEP_TIME  ","\n","    SLEEP_TIME=$(($SLEEP_TIME * 2)) ","\n","  else ","\n","    echo Sleeping $SLEEP_TIME_MAX  ","\n","    sleep $SLEEP_TIME_MAX  ","\n","  fi","\n","}","\n\n","# Executing bootstrap script","\n","SLEEP_TIME=10","\n","SLEEP_TIME_MAX=3600","\n","while true; do ","\n","  curl ",{"Fn::FindInMap":["AWSEBOptions","options","UserDataScript"]}," > \/tmp\/ebbootstrap.sh ","\n","  RESULT=$?","\n","  if [[ \"$RESULT\" -ne 0 ]]; then ","\n","    sleep_delay ","\n","  else","\n","    \/bin\/bash \/tmp\/ebbootstrap.sh ","    '",{"Fn::FindInMap":["AWSEBOptions","options","pythonlibs"]},"'","    '",{"Fn::FindInMap":["AWSEBOptions","options","rpms"]},"'","    '",{"Fn::FindInMap":["AWSEBOptions","options","tarballs"]},"'","    '",{"Fn::FindInMap":["AWSEBOptions","options","ebgems"]},"'","    '",{"Ref":"AWSEBInstanceLaunchWaitHandle"},"'","    '",{"Ref":"AWS::StackId"},"'","    '",{"Ref":"AWS::Region"},"'","    '",{"Fn::FindInMap":["AWSEBOptions","options","guid"]},"'","    && ","\n","    exit 0  ","\n","  fi ","\n","done","\n\n","--===============5189065377222898407==-- "]]}},"InstanceType":{"Ref":"InstanceType"},"KeyName":"nando-demo-20150409171905"}},"AWSEBAutoScalingGroup":{"Type":"AWS::AutoScaling::AutoScalingGroup","Metadata":{"AWS::ElasticBeanstalk::Ext":{"_EnvironmentInfoTaskMapping":"EnvironmentInfoTasks","_TriggersConfig":{"applicationDeploy":{"_Command":"CMD-AppDeploy","_WatchGroups":["_TriggerAppDeployment"]},"configDeploy":{"_Command":"CMD-ConfigDeploy","_WatchGroups":["_TriggerConfigDeployment"]}},"_ParameterTriggers":{"_TriggerAppDeployment":["AppSource"],"_TriggerConfigDeployment":["EnvironmentVariables","InstancePort","LogPublicationControl","DockerProxyServer"]},"_ContainerConfigFileContent":{"system":{"LogPublicationControl":{"Ref":"LogPublicationControl"},"AWSEBReferrerId":{"Ref":"AWSEBReferrerId"},"AWSEBAgentId":{"Ref":"AWSEBAgentId"}},"container":{"staging_image":"aws_beanstalk\/staging-app","runtime_image":"amazon\/aws-eb-python:3.4.2-onbuild-3.5.1","instance_port":{"Ref":"InstancePort"},"docker_ps_log":"\/var\/log\/docker-ps.log","app_deploy_file":"\/etc\/elasticbeanstalk\/.aws_beanstalk.current-container-id","app_staging_file":"\/etc\/elasticbeanstalk\/.aws_beanstalk.staging-container-id","runtime_default_log":"\/var\/log\/uwsgi","source_bundle":"\/opt\/elasticbeanstalk\/deploy\/appsource\/source_bundle","deploy_image":"aws_beanstalk\/current-app","app_deploy_dir":"\/var\/app\/current","host_log_dir":"\/var\/log\/eb-docker\/containers\/eb-current-app","runtime_dockerfile":"\/opt\/elasticbeanstalk\/containerfiles\/support\/extra\/python3-runtime","docker_events_log":"\/var\/log\/docker-events.log","port_file":"\/etc\/elasticbeanstalk\/.aws_beanstalk.container-port","proxy_server":{"Ref":"DockerProxyServer"},"support_files_dir":"\/opt\/elasticbeanstalk\/containerfiles\/support"},"optionsettings":{"aws:elasticbeanstalk:hostmanager":{"LogPublicationControl":{"Ref":"LogPublicationControl"}},"aws:elasticbeanstalk:application:environment":{"Ref":"EnvironmentVariables"}},"commands":{"CMD-ConfigDeploy":{"stages":[{"name":"ConfigDeployStage0","actions":[{"name":"InfraWriteConfig","value":"writeruntimeconfig","type":"infra"},{"name":"ConfigDeployPreHook","value":"configdeploy\/pre","type":"hook"}]},{"name":"ConfigDeployStage1","actions":[{"name":"ConfigDeployEnactHook","value":"configdeploy\/enact","type":"hook"},{"name":"ConfigDeployPostHook","value":"configdeploy\/post","type":"hook"}]}]},"CMD-BundleLogs":{"stages":[{"name":"BundleLogs","actions":[{"name":"BundleLogs","value":"bundleLogs.py --conf-path '\/opt\/elasticbeanstalk\/tasks\/bundlelogs.d\/*' --location-prefix 'resources\/environments\/logs\/bundle\/'","type":"sh"}]}]},"CMD-SelfStartup":{"stages":[{"name":"StartupStage0","leader_election":false,"actions":[{"name":"EbExtensionPreBuild","value":"embeddedprebuild","type":"infra"},{"name":"AppDeployPreHook","value":"appdeploy\/pre","type":"hook"},{"name":"EbExtensionPostBuild","value":"embeddedpostbuild","type":"infra"},{"name":"InfraCleanEbextension","value":"cleanebextensions","type":"infra"}]},{"name":"StartupStage1","actions":[{"name":"AppDeployEnactHook","value":"appdeploy\/enact","type":"hook"},{"name":"AppDeployPostHook","value":"appdeploy\/post","type":"hook"},{"name":"PostInitHook","value":"postinit","type":"hook"}]}]},"CMD-SystemTailLogs":{"stages":[{"name":"SystemTailLogs","actions":[{"name":"SystemTailLogs","value":"tailLogs.py --concatenate --conf-path '\/opt\/elasticbeanstalk\/tasks\/systemtaillogs.d\/*' --location-prefix 'resources\/environments\/logs\/systemtail\/'","type":"sh"}]}]},"CMD-TailLogs":{"stages":[{"name":"TailLogsDockerPS","actions":[{"name":"DockerPS","value":"echo \"'docker ps' ran at `date`: \" >> \/var\/log\/docker-ps.log && docker ps >> \/var\/log\/docker-ps.log","type":"sh"}]},{"name":"TailLogs","actions":[{"name":"TailLogs","value":"tailLogs.py --concatenate --conf-path '\/opt\/elasticbeanstalk\/tasks\/taillogs.d\/*' --location-prefix 'resources\/environments\/logs\/tail\/'","type":"sh"}]}]},"CMD-PreInit":{"stages":[{"name":"PreInitStage0","actions":[{"name":"InfraWriteConfig","value":"writeruntimeconfig","type":"infra"},{"name":"InfraWriteApp1","value":"writeapplication1","type":"infra"},{"name":"InfraWriteApp2","value":"writeapplication2","type":"infra"},{"name":"PreInitHook","value":"preinit","type":"hook"}]}]},"CMD-RestartAppServer":{"stages":[{"name":"RestartAppServerStage0","actions":[{"name":"InfraWriteConfig","value":"writeruntimeconfig","type":"infra"},{"name":"RestartAppServerPreHook","value":"restartappserver\/pre","type":"hook"}]},{"name":"RestartAppServerStage1","actions":[{"name":"RestartAppServerEnactHook","value":"restartappserver\/enact","type":"hook"},{"name":"RestartAppServerPostHook","value":"restartappserver\/post","type":"hook"}]}]},"CMD-Startup":{"stages":[{"name":"StartupStage0","leader_election":true,"actions":[{"name":"EbExtensionPreBuild","value":"embeddedprebuild","type":"infra"},{"name":"AppDeployPreHook","value":"appdeploy\/pre","type":"hook"},{"name":"EbExtensionPostBuild","value":"embeddedpostbuild","type":"infra"},{"name":"InfraCleanEbExtension","value":"cleanebextensions","type":"infra"}]},{"name":"StartupStage1","actions":[{"name":"AppDeployEnactHook","value":"appdeploy\/enact","type":"hook"},{"name":"AppDeployPostHook","value":"appdeploy\/post","type":"hook"},{"name":"PostInitHook","value":"postinit","type":"hook"}]}]},"CMD-PublishLogs":{"stages":[{"name":"PublishLogs","actions":[{"name":"PublishLogs","value":"publishLogs.py --de-dupe --conf-path '\/opt\/elasticbeanstalk\/tasks\/publishlogs.d\/*' --location-prefix 'resources\/environments\/logs\/publish\/' --num-concurrent 2","type":"sh"}]}]},"CMD-AppDeploy":{"stages":[{"name":"AppDeployStage0","leader_election":true,"actions":[{"name":"InfraWriteConfig","value":"writeruntimeconfig","type":"infra"},{"name":"InfraWriteApp1","value":"writeapplication1","type":"infra"},{"name":"InfraWriteApp2","value":"writeapplication2","type":"infra"},{"name":"EbExtensionPreBuild","value":"embeddedprebuild","type":"infra"},{"name":"AppDeployPreHook","value":"appdeploy\/pre","type":"hook"},{"name":"EbExtensionPostBuild","value":"embeddedpostbuild","type":"infra"},{"name":"InfraCleanEbextension","value":"cleanebextensions","type":"infra"}]},{"name":"AppDeployStage1","actions":[{"name":"AppDeployEnactHook","value":"appdeploy\/enact","type":"hook"},{"name":"AppDeployPostHook","value":"appdeploy\/post","type":"hook"}]}]}}},"_LaunchS3URL":"https:\/\/s3.amazonaws.com\/elasticbeanstalk-us-east-1-324320755747\/resources\/environments\/e-znztckesyk\/nandoAutomationDemo-env_LaunchFile","_API":{"_Commands":{"CMD-BundleLogs":{"_Stages":{"01_enact":["InfoTask-BundleLogs"]}},"CMD-ConfigDeploy":{"_Stages":{"02_enact":[],"01_pre":[]},"_RunStaged":"true"},"CMD-SystemTailLogs":{"_Stages":{"01_enact":["InfoTask-SystemTailLogs"]}},"CMD-TailLogs":{"_Stages":{"01_enact":["InfoTask-TailLogs"]}},"CMD-PatchInstance":{"_Stages":{"01_enact":["_Infra-PatchInstance"]}},"CMD-Startup":{"_Stages":{"02_enact":[],"01_pre":[]},"_RunStaged":"true"},"CMD-RestartAppServer":{"_Stages":{"02_enact":[],"01_enact":[]},"_RunStaged":"false"},"CMD-AppDeploy":{"_Stages":{"02_enact":[],"01_pre":[]},"_RunStaged":"true"}}},"AvailabilityZoneCount":"Any","_AppSourceUrlFileContent":{"url":{"Ref":"AppSource"}}},"AWS::CloudFormation::Init":{"Infra-WriteApplication1":{"commands":{"01mkdir":{"command":"rm -rf \/opt\/elasticbeanstalk\/deploy\/appsource\/; mkdir -p \/opt\/elasticbeanstalk\/deploy\/appsource\/"}}},"Infra-WritePublishLogsCron":{"files":{"\/etc\/cron.d\/publishlogs":{"content":{"Fn::Join":["",["SHELL=\/bin\/bash","\n","PATH=\/sbin:\/bin:\/usr\/sbin:\/usr\/bin","\n","MAILTO=\"\"","\n","HOME=\/","\n","10,30,50 * * * * root ","publishLogs.py --de-dupe --conf-path '\/opt\/elasticbeanstalk\/tasks\/publishlogs.d\/*' --location-prefix ",{"Fn::FindInMap":["EnvironmentInfoTasks","publish","LocationPrefix"]}," --num-concurrent 2","\n","05,25,45 * * * * root ","clearStaleLogPublishingRecords.py","\n"]]},"mode":"000644"}}},"Infra-WriteBundleLogsConf":{"files":{"\/opt\/elasticbeanstalk\/tasks\/bundlelogs.d\/eb-system.conf":{"content":{"Fn::Join":["\n",["\/var\/log\/eb-cfn-init*","\/var\/log\/eb-tools*","\/var\/log\/eb-publish-logs*","\/var\/log\/eb-commandprocessor*","\/var\/log\/eb-activity*",""]]},"mode":"000644"},"\/opt\/elasticbeanstalk\/tasks\/bundlelogs.d\/cfn-system.conf":{"content":{"Fn::Join":["\n",["\/var\/log\/cfn-hup*","\/var\/log\/cfn-init*",""]]},"mode":"000644"},"\/opt\/elasticbeanstalk\/tasks\/bundlelogs.d\/eb-version-deployment.conf":{"content":{"Fn::Join":["\n",["\/var\/log\/eb-version-deployment.log",""]]}},"\/opt\/elasticbeanstalk\/tasks\/bundlelogs.d\/cloud-init-system.conf":{"content":{"Fn::Join":["\n",["\/var\/log\/cloud-init*",""]]},"mode":"000644"},"\/opt\/elasticbeanstalk\/tasks\/bundlelogs.d\/system.conf":{"content":{"Fn::Join":["\n",["\/var\/log\/cron","\/var\/log\/messages","\/var\/log\/yum.log",""]]},"mode":"000644"}}},"AWSEBBaseConfig":{"files":{"\/etc\/init\/cfn-hup.conf":{"content":{"Fn::Join":["\n",["stop on runlevel [016]","respawn","script","  \/opt\/aws\/bin\/cfn-hup","end script"]]},"owner":"root","group":"root","mode":"000400"},"\/etc\/elasticbeanstalk\/.aws-eb-stack.properties":{"content":{"Fn::Join":["",["environment_id=",{"Ref":"AWSEBEnvironmentId"},"\n","environment_bucket=",{"Ref":"AWSEBEnvironmentBucket"},"\n","stack_name=",{"Ref":"AWS::StackId"},"\n","resource=","AWSEBAutoScalingGroup","\n","region=",{"Ref":"AWS::Region"},"\n\n"]]},"owner":"root","group":"root","mode":"000440"},"\/etc\/cfn\/cfn-hup.conf":{"content":{"Fn::Join":["",["[main]","\n","stack=",{"Ref":"AWS::StackId"},"\n","region=",{"Ref":"AWS::Region"},"\n","verbose=true\n","multi-threaded=false\n"]]},"owner":"root","group":"root","mode":"000400"},"\/etc\/cfn\/hooks.d\/aws-eb-command-handler.conf":{"content":{"Fn::Join":["",["[aws-eb-command-handler]","\n","triggers=on.command","\n","path=ElasticBeanstalkCommand-","AWSEBAutoScalingGroup","\n","action=\/opt\/elasticbeanstalk\/bin\/command-processor","\n"]]}}},"commands":{"clearbackupfiles":{"command":"rm -f \/etc\/cfn\/hooks.d\/*.bak"}}},"Infra-WriteApplication2":{"files":{"\/opt\/elasticbeanstalk\/bin\/download_source_bundle":{"source":{"Fn::Select":[0,{"Fn::FindInMap":["AWSEBOptions","options","downloadSourceBundleScriptLocation"]}]},"owner":"root","group":"root","mode":"000750"}},"commands":{"01downloadVersion":{"command":"\/opt\/elasticbeanstalk\/bin\/download_source_bundle"},"02deleteVersionDownloadScriptFile":{"command":"rm \/opt\/elasticbeanstalk\/bin\/download_source_bundle"}}},"InfoTask-TailLogs":{"commands":{"taillogs":{"command":{"Fn::Join":["",["tailLogs.py --concatenate --conf-path '\/opt\/elasticbeanstalk\/tasks\/taillogs.d\/*' --location-prefix ",{"Fn::FindInMap":["EnvironmentInfoTasks","tail","LocationPrefix"]}]]}}}},"InfoTask-BundleLogs":{"commands":{"bundlelogs":{"command":{"Fn::Join":["",["bundleLogs.py --conf-path '\/opt\/elasticbeanstalk\/tasks\/bundlelogs.d\/*' --location-prefix ",{"Fn::FindInMap":["EnvironmentInfoTasks","bundle","LocationPrefix"]}]]}}}},"Infra-InstallBaseHooksPkg":{"sources":{"\/opt\/elasticbeanstalk":"https:\/\/s3.amazonaws.com\/elasticbeanstalk-env-resources-us-east-1\/stalks\/eb_docker_python3_3.12.1\/lib\/basehooks.tar.gz"}},"Hook-PreAppDeploy":{"commands":{"hooks":{"command":"echo place holder"}}},"configSets":{"_OnInstanceBoot":["AWSEBBaseConfig","Infra-InstallBaseHooksPkg","Infra-InstallContainerHooksPkg","Infra-WriteLeaderTestScript","Infra-WriteTailLogsConf","Infra-WriteSystemTailLogsConf","Infra-WriteBundleLogsConf","Infra-WritePublishLogsConf","Infra-WritePublishLogsCron"],"Infra-WriteApplication1":["Infra-WriteApplication1"],"Infra-WritePublishLogsCron":["Infra-WritePublishLogsCron"],"_Infra-PatchInstance":["Infra-PatchInstance"],"Infra-WriteBundleLogsConf":["Infra-WriteBundleLogsConf"],"Infra-EmbeddedPostBuild":[],"Infra-WriteApplication2":["Infra-WriteApplication2"],"InfoTask-TailLogs":["InfoTask-TailLogs"],"_AppInstall":["Hook-PreAppDeploy"],"_OnInstanceReboot":["AWSEBBaseConfig"],"InfoTask-BundleLogs":["InfoTask-BundleLogs"],"Infra-EmbeddedPreBuild":[],"Hook-PreAppDeploy":["Hook-PreAppDeploy"],"InfoTask-SystemTailLogs":["InfoTask-SystemTailLogs"],"Infra-WriteTailLogsConf":["Infra-WriteTailLogsConf"],"Infra-WritePublishLogsConf":["Infra-WritePublishLogsConf"],"Infra-WriteSystemTailLogsConf":["Infra-WriteSystemTailLogsConf"]},"Infra-WriteLeaderTestScript":{"files":{"\/opt\/elasticbeanstalk\/bin\/leader-test.sh":{"content":{"Fn::Join":["",["#!\/bin\/bash","\n","if [[ \"$EB_IS_COMMAND_LEADER\" == \"true\" ]]; then ","\n","  exit 0 ","\n","else  ","\n","  exit 1 ","\n","fi ","\n"]]},"mode":"000755"}}},"Infra-InstallContainerHooksPkg":{"sources":{"\/opt\/elasticbeanstalk":{"Ref":"HooksPkgUrl"}}},"InfoTask-SystemTailLogs":{"commands":{"systemtaillogs":{"command":{"Fn::Join":["",["tailLogs.py --conf-path '\/opt\/elasticbeanstalk\/tasks\/systemtaillogs.d\/*' --location-prefix ",{"Fn::FindInMap":["EnvironmentInfoTasks","systemtail","LocationPrefix"]}]]}}}},"Infra-WriteTailLogsConf":{"files":{"\/opt\/elasticbeanstalk\/tasks\/taillogs.d\/eb-version-deployment.conf":{"content":{"Fn::Join":["\n",["\/var\/log\/eb-version-deployment.log",""]]}},"\/opt\/elasticbeanstalk\/tasks\/taillogs.d\/eb-activity.conf":{"content":{"Fn::Join":["\n",["\/var\/log\/eb-commandprocessor.log","\/var\/log\/eb-activity.log",""]]},"mode":"000644"}}},"Infra-WritePublishLogsConf":{"files":{}},"Infra-WriteSystemTailLogsConf":{"files":{"\/opt\/elasticbeanstalk\/tasks\/systemtaillogs.d\/eb-version-deployment.conf":{"content":{"Fn::Join":["\n",["\/var\/log\/eb-version-deployment.log",""]]}},"\/opt\/elasticbeanstalk\/tasks\/systemtaillogs.d\/eb-system.conf":{"content":{"Fn::Join":["\n",["\/var\/log\/eb-cfn-init.log","\/var\/log\/eb-tools.log","\/var\/log\/eb-publish-logs.log","\/var\/log\/eb-commandprocessor.log","\/var\/log\/eb-activity.log",""]]},"mode":"000644"},"\/opt\/elasticbeanstalk\/tasks\/systemtaillogs.d\/system.conf":{"content":{"Fn::Join":["\n",["\/var\/log\/cron","\/var\/log\/messages","\/var\/log\/yum.log",""]]},"mode":"000644"},"\/opt\/elasticbeanstalk\/tasks\/systemtaillogs.d\/cloud-init-system.conf":{"content":{"Fn::Join":["\n",["\/var\/log\/cloud-init.log",""]]},"mode":"000644"},"\/opt\/elasticbeanstalk\/tasks\/systemtaillogs.d\/cfn-system.conf":{"content":{"Fn::Join":["\n",["\/var\/log\/cfn-hup.log","\/var\/log\/cfn-init.log",""]]},"mode":"000644"}}},"Infra-PatchInstance":{"files":{"\/opt\/elasticbeanstalk\/bin\/patch_instance":{"source":{"Fn::Select":[0,{"Fn::FindInMap":["AWSEBOptions","options","ebpatchscripturl"]}]},"owner":"root","group":"root","mode":"000750"}},"commands":{"01executepatch":{"command":"\/opt\/elasticbeanstalk\/bin\/patch_instance"}}}},"ForcingMetadataUpdate":"Changing something in the metadata will force re-compuation"},"DependsOn":"AWSEBBeanstalkMetadata","Properties":{"Tags":[{"PropagateAtLaunch":true,"Value":{"Ref":"AWSEBEnvironmentName"},"Key":"elasticbeanstalk:environment-name"},{"PropagateAtLaunch":true,"Value":{"Ref":"AWSEBEnvironmentName"},"Key":"Name"},{"PropagateAtLaunch":true,"Value":{"Ref":"AWSEBEnvironmentId"},"Key":"elasticbeanstalk:environment-id"}],"AvailabilityZones":["us-east-1c","us-east-1e","us-east-1d"],"MaxSize":1,"Cooldown":"360","LaunchConfigurationName":{"Ref":"AWSEBAutoScalingLaunchConfiguration"},"MinSize":1}},"AWSEBSecurityGroup":{"Type":"AWS::EC2::SecurityGroup","Properties":{"GroupDescription":"SecurityGroup for ElasticBeanstalk environment.","SecurityGroupIngress":[{"IpProtocol":"tcp","ToPort":{"Ref":"InstancePort"},"FromPort":{"Ref":"InstancePort"},"CidrIp":"0.0.0.0\/0"}]}},"AWSEBInstanceLaunchWaitHandle":{"Type":"AWS::CloudFormation::WaitConditionHandle"},"AWSEBSecurityGroupSSHIngress":{"Type":"AWS::EC2::SecurityGroupIngress","Properties":{"IpProtocol":"tcp","GroupName":{"Ref":"AWSEBSecurityGroup"},"ToPort":"22","FromPort":"22","CidrIp":"0.0.0.0\/0"}},"AWSEBBeanstalkMetadata":{"Type":"AWS::CloudFormation::WaitConditionHandle","Metadata":{"AWS::ElasticBeanstalk::Ext":{"Parameters":{"HooksPkgUrl":{"Ref":"HooksPkgUrl"},"LogPublicationControl":{"Ref":"LogPublicationControl"},"AWSEBReferrerId":{"Ref":"AWSEBReferrerId"},"DockerProxyServer":{"Ref":"DockerProxyServer"},"InstancePort":{"Ref":"InstancePort"},"AWSEBEnvironmentId":{"Ref":"AWSEBEnvironmentId"},"AWSEBAgentId":{"Ref":"AWSEBAgentId"},"AWSEBEnvironmentName":{"Ref":"AWSEBEnvironmentName"},"AWSEBEnvironmentBucket":{"Ref":"AWSEBEnvironmentBucket"},"AppSource":{"Ref":"AppSource"},"EnvironmentVariables":{"Ref":"EnvironmentVariables"},"InstanceType":{"Ref":"InstanceType"}}},"AWS::ElasticBeanstalk::Metadata":{"Name":"e-znztckesyk","EnvironmentName":"nandoAutomationDemo-env","RequestId":"e748a78d-df30-11e4-a0c3-a1c027aa23ff","DateCreated":"2015-04-10T03:23:06","DateUpdated":"2015-04-10T03:23:06","EnvironmentId":"e-znztckesyk","Version":"e748a78d-df30-11e4-a0c3-a1c027aa23ff"}},"DependsOn":"AWSEBEIP"},"AWSEBEIP":{"Type":"AWS::EC2::EIP","Metadata":{"AWS::ElasticBeanstalk::Ext":{"AutoScalingGroup":"AWSEBAutoScalingGroup"},"Description":"Elastic IP Address used as entry point of Single Instance Environment"}}}}
